<!doctype html><html lang=en><head><title>hadoop集群搭建（二）之集群配置 · YanHowey Wang
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="YanHowey Wang"><meta name=description content="hadoop 集群搭建（二）之集群配置 Link to heading @TOC
一、集群部署规划 Link to heading 1.NameNode 和 SecoundNameNode 不要安装在同一台服务器 2.ResourceManager 也很消耗内存，不要和 NameNode、SecoundNameNode 配置在同一台机器上
hadoop102 hadoop103 hadoop104 HDFS NameNode DataNode DataNode SecoundNameNode DataNode yarn NodeManager ResourceManager NodeManager NodeManager 二、修改配置文件 Link to heading 1. /opt/module/hadoop-3.3.1/etc/hadoop/core-site.xml Link to heading <configuration> <!--指定nodename地址 --> <property> <name>fs.defaultFS</name> <value>hdfs://hadoop102:8020</value> </property> <!-- ָ指定hadoop数据的存储目录 --> <property> <name>hadoop.tmp.dir</name> <value>/opt/module/hadoop-3.3.1/data</value> </property> <!-- 配置hsfs网页登录使用的静态用户--> <!-- <property> --> <!-- <name>hadoop.http.staticuser.user</name> --> <!-- <value>howey</value> --> <!-- </property> --> </configuration> 2."><meta name=keywords content="blog,编程,前端,后端"><meta name=twitter:card content="summary"><meta name=twitter:title content="hadoop集群搭建（二）之集群配置"><meta name=twitter:description content="hadoop 集群搭建（二）之集群配置 Link to heading @TOC
一、集群部署规划 Link to heading 1.NameNode 和 SecoundNameNode 不要安装在同一台服务器 2.ResourceManager 也很消耗内存，不要和 NameNode、SecoundNameNode 配置在同一台机器上
hadoop102 hadoop103 hadoop104 HDFS NameNode DataNode DataNode SecoundNameNode DataNode yarn NodeManager ResourceManager NodeManager NodeManager 二、修改配置文件 Link to heading 1. /opt/module/hadoop-3.3.1/etc/hadoop/core-site.xml Link to heading <configuration> <!--指定nodename地址 --> <property> <name>fs.defaultFS</name> <value>hdfs://hadoop102:8020</value> </property> <!-- ָ指定hadoop数据的存储目录 --> <property> <name>hadoop.tmp.dir</name> <value>/opt/module/hadoop-3.3.1/data</value> </property> <!-- 配置hsfs网页登录使用的静态用户--> <!-- <property> --> <!-- <name>hadoop.http.staticuser.user</name> --> <!-- <value>howey</value> --> <!-- </property> --> </configuration> 2."><meta property="og:url" content="https://howey.deno.dev/posts/2307262205/"><meta property="og:site_name" content="YanHowey Wang"><meta property="og:title" content="hadoop集群搭建（二）之集群配置"><meta property="og:description" content="hadoop 集群搭建（二）之集群配置 Link to heading @TOC
一、集群部署规划 Link to heading 1.NameNode 和 SecoundNameNode 不要安装在同一台服务器 2.ResourceManager 也很消耗内存，不要和 NameNode、SecoundNameNode 配置在同一台机器上
hadoop102 hadoop103 hadoop104 HDFS NameNode DataNode DataNode SecoundNameNode DataNode yarn NodeManager ResourceManager NodeManager NodeManager 二、修改配置文件 Link to heading 1. /opt/module/hadoop-3.3.1/etc/hadoop/core-site.xml Link to heading &amp;lt;configuration&amp;gt; &amp;lt;!--指定nodename地址 --&amp;gt; &amp;lt;property&amp;gt; &amp;lt;name&amp;gt;fs.defaultFS&amp;lt;/name&amp;gt; &amp;lt;value&amp;gt;hdfs://hadoop102:8020&amp;lt;/value&amp;gt; &amp;lt;/property&amp;gt; &amp;lt;!-- ָ指定hadoop数据的存储目录 --&amp;gt; &amp;lt;property&amp;gt; &amp;lt;name&amp;gt;hadoop.tmp.dir&amp;lt;/name&amp;gt; &amp;lt;value&amp;gt;/opt/module/hadoop-3.3.1/data&amp;lt;/value&amp;gt; &amp;lt;/property&amp;gt; &amp;lt;!-- 配置hsfs网页登录使用的静态用户--&amp;gt; &amp;lt;!-- &amp;lt;property&amp;gt; --&amp;gt; &amp;lt;!-- &amp;lt;name&amp;gt;hadoop.http.staticuser.user&amp;lt;/name&amp;gt; --&amp;gt; &amp;lt;!-- &amp;lt;value&amp;gt;howey&amp;lt;/value&amp;gt; --&amp;gt; &amp;lt;!-- &amp;lt;/property&amp;gt; --&amp;gt; &amp;lt;/configuration&amp;gt; 2."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-26T22:21:16+08:00"><meta property="article:modified_time" content="2023-07-26T22:21:16+08:00"><meta property="article:tag" content="Hadoop"><meta property="article:tag" content="Shell"><meta property="og:see_also" content="https://howey.deno.dev/posts/2309091559/"><meta property="og:see_also" content="https://howey.deno.dev/posts/2309021559/"><meta property="og:see_also" content="https://howey.deno.dev/posts/2308071644/"><meta property="og:see_also" content="https://howey.deno.dev/posts/2308070926/"><meta property="og:see_also" content="https://howey.deno.dev/posts/2308070957/"><meta property="og:see_also" content="https://howey.deno.dev/posts/2308061943/"><meta property="og:see_also" content="https://howey.deno.dev/posts/2308052141/"><link rel=canonical href=https://howey.deno.dev/posts/2307262205/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.5adbe72fc41dcfb852215b84695288939b6b606db73238bd3ee936469572fc9c.css integrity="sha256-WtvnL8Qdz7hSIVuEaVKIk5trYG23Mji9Puk2RpVy/Jw=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/pagination.min.ed23f65c60bf3db5f28ed3b249e384cd64c7980184d5100b6d22f278be00ef1a.css integrity="sha256-7SP2XGC/PbXyjtOySeOEzWTHmAGE1RALbSLyeL4A7xo=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>YanHowey Wang
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/categories/>Categories</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/website/>WebSite</a></li><li class=navigation-item><a class=navigation-link href=/contact/>Contact me</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://howey.deno.dev/posts/2307262205/>hadoop集群搭建（二）之集群配置</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2023-07-26T22:21:16+08:00>July 26, 2023
</time></span><span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
3-minute read</span></div><div class=authors><i class="fa fa-user" aria-hidden=true></i>
<a href=/authors/howey/>Howey</a></div><div class=categories><i class="fa fa-folder" aria-hidden=true></i>
<a href=/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/>大数据</a></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/hadoop/>Hadoop</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/shell/>Shell</a></span></div></div></header><div class=post-content><h1 id=hadoop-集群搭建二之集群配置>hadoop 集群搭建（二）之集群配置
<a class=heading-link href=#hadoop-%e9%9b%86%e7%be%a4%e6%90%ad%e5%bb%ba%e4%ba%8c%e4%b9%8b%e9%9b%86%e7%be%a4%e9%85%8d%e7%bd%ae><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><hr><p>@<a href=%e6%96%87%e7%ab%a0%e7%9b%ae%e5%bd%95>TOC</a></p><hr><h2 id=一集群部署规划>一、集群部署规划
<a class=heading-link href=#%e4%b8%80%e9%9b%86%e7%be%a4%e9%83%a8%e7%bd%b2%e8%a7%84%e5%88%92><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><blockquote><p>1.NameNode 和 SecoundNameNode 不要安装在同一台服务器
2.ResourceManager 也很消耗内存，不要和 NameNode、SecoundNameNode 配置在同一台机器上</p></blockquote><table><thead><tr><th></th><th>hadoop102</th><th>hadoop103</th><th>hadoop104</th></tr></thead><tbody><tr><td>HDFS</td><td>NameNode DataNode</td><td>DataNode</td><td>SecoundNameNode DataNode</td></tr><tr><td>yarn</td><td>NodeManager</td><td>ResourceManager NodeManager</td><td>NodeManager</td></tr></tbody></table><h2 id=二修改配置文件>二、修改配置文件
<a class=heading-link href=#%e4%ba%8c%e4%bf%ae%e6%94%b9%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><h3 id=1-optmodulehadoop-331etchadoopcore-sitexml>1. /opt/module/hadoop-3.3.1/etc/hadoop/core-site.xml
<a class=heading-link href=#1-optmodulehadoop-331etchadoopcore-sitexml><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;configuration&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!--指定nodename地址 --&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>fs.defaultFS<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>hdfs://hadoop102:8020<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>	<span class=c>&lt;!-- ָ指定hadoop数据的存储目录 --&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>hadoop.tmp.dir<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>/opt/module/hadoop-3.3.1/data<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>	<span class=c>&lt;!-- 配置hsfs网页登录使用的静态用户--&gt;</span>
</span></span><span class=line><span class=cl>	<span class=c>&lt;!-- &lt;property&gt; --&gt;</span>
</span></span><span class=line><span class=cl>		<span class=c>&lt;!-- &lt;name&gt;hadoop.http.staticuser.user&lt;/name&gt; --&gt;</span>
</span></span><span class=line><span class=cl>		<span class=c>&lt;!-- &lt;value&gt;howey&lt;/value&gt; --&gt;</span>
</span></span><span class=line><span class=cl>	<span class=c>&lt;!-- &lt;/property&gt; --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/configuration&gt;</span>
</span></span></code></pre></div><h3 id=2-optmodulehadoop-331etchadoophdfs-sitexml>2. /opt/module/hadoop-3.3.1/etc/hadoop/hdfs-site.xml
<a class=heading-link href=#2-optmodulehadoop-331etchadoophdfs-sitexml><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;configuration&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- nn 外部访问地址--&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>dfs.namenode.http-address<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>hadoop102:9870<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>	<span class=c>&lt;!-- 2nn 外部访问地址--&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>dfs.namenode.secondary.http-address<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>hadoop104:9868<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/configuration&gt;</span>
</span></span></code></pre></div><h3 id=3-optmodulehadoop-331etchadoopyarn-sitexml>3. /opt/module/hadoop-3.3.1/etc/hadoop/yarn-site.xml
<a class=heading-link href=#3-optmodulehadoop-331etchadoopyarn-sitexml><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;configuration&gt;</span>
</span></span><span class=line><span class=cl>	<span class=c>&lt;!-- nn 指定mr走shuffle--&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>yarn.nodemanager.aux-services<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>mapreduce_shuffle<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=c>&lt;!-- 指定resourcemanager的地址--&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>yarn.resourcemanager.hostname<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>hadoop103<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>	<span class=c>&lt;!-- 指定环境变量的继承--&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>yarn.nodemanager.env-whitelist<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>			<span class=c>&lt;!-- 开启日志聚集功能--&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>yarn.log-aggregation-enable<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>true<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>	<span class=c>&lt;!-- 设置日志聚集服务器地址 --&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>yarn.log-server.url<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>http://hadoop102:19888/jobhistory/logs<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>	<span class=c>&lt;!-- 设置日志保留时间为7天 --&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>yarn.log-aggregation.retain-seconds<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>604800<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/configuration&gt;</span>
</span></span></code></pre></div><h3 id=4历史服务器配置>4.历史服务器配置
<a class=heading-link href=#4%e5%8e%86%e5%8f%b2%e6%9c%8d%e5%8a%a1%e5%99%a8%e9%85%8d%e7%bd%ae><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>/opt/module/hadoop-3.3.1/etc/hadoop/mapred-site.xml</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;configuration&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- 指定MapReduce程序运行在Yarn上 --&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>mapreduce.framework.name<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>yarn<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- 历史服务器端地址 --&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>mapreduce.jobhistory.address<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>hadoop102:10020<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>	<span class=c>&lt;!-- 历史服务器web端地址 --&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;name&gt;</span>mapreduce.jobhistory.webapp.address<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;value&gt;</span>hadoop102:19888<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/configuration&gt;</span>
</span></span></code></pre></div><h3 id=4配置-works-文件>4.配置 works 文件：
<a class=heading-link href=#4%e9%85%8d%e7%bd%ae-works-%e6%96%87%e4%bb%b6><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p><code>/opt/module/hadoop-3.3.1/etc/hadoop/workers</code>
<img alt=在这里插入图片描述 src=https://img-blog.csdnimg.cn/a97752387fa6493da7d1ff24f4d46ea8.png></p><h3 id=5进行集群配置文件分发>5.进行集群配置文件分发
<a class=heading-link href=#5%e8%bf%9b%e8%a1%8c%e9%9b%86%e7%be%a4%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6%e5%88%86%e5%8f%91><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><h2 id=三启动>三、启动
<a class=heading-link href=#%e4%b8%89%e5%90%af%e5%8a%a8><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p><code>注意：</code>第一次启动需要格式化，一定要注意自己使用的那个账号在操作，不要一会 root 一会普通账号
检查<code>/opt/module/hadoop-3.3.1/data</code>文件夹的文件所属
格式化之前先删除<code>/opt/module/hadoop-3.3.1/logs</code>和<code>/opt/module/hadoop-3.3.1/data</code>
格式化：
<code>hdfs namenode -format</code>
启动：
<code>/opt/module/hadoop-3.3.1/sbin/start-dfs.sh</code>
停止：
<code>/opt/module/hadoop-3.3.1/sbin/stop-dfs.sh</code>
检查：
<code>jps</code></p><p>根据顶部图可判断需要在服务器 103 上启动 yarn
<code>/opt/module/hadoop-3.3.1/sbin/start-yarn.sh</code>
<code>mapred --daemon start historyserver</code>
开启停止各服务组件(kill -9 进程号)
<code>hdfs --daemon start/stop namenode/datanode/secondarynamenode</code>
yarn 的重启服务
<code>yarn --daemon start/stop resourcemanager/nodemanager</code></p><p>web 端查看
HDFS 存储信息
<code>http://hadoop102:9870/</code>
yarn 的 resourcemanager
<code>http://hadoop103:8088/</code></p><h2 id=四测试>四、测试
<a class=heading-link href=#%e5%9b%9b%e6%b5%8b%e8%af%95><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p><code>hadoop fs -mkdir /wcinput</code>
<code>hadoop fs -put /opt/software/jdk-8u331-linux-x64.tar.gz /wcinput</code>
查看 web
<code>http://hadoop102:9870/explorer.html#/</code>
文件存储位置 core-site.xml</p><p><img alt=在这里插入图片描述 src=https://img-blog.csdnimg.cn/95d07e3ce6e449baad6cc1af0c50eb3e.png>
<code>ll data/dfs/data/current/BP-15966323-192.168.10.102-1650898590994/current/finalized/subdir0/subdir0/</code></p><p>表示三个副本
<img alt=在这里插入图片描述 src="https://img-blog.csdnimg.cn/cb9f1b9e4efe4f7c92991b44b4839da7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAUG15eF93eWg=,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h2 id=五集群崩溃处理>五、集群崩溃处理
<a class=heading-link href=#%e4%ba%94%e9%9b%86%e7%be%a4%e5%b4%a9%e6%ba%83%e5%a4%84%e7%90%86><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ol><li>停止 yarn 服务</li><li>停止 hdfs 服务</li><li>删除所有服务器节点 /opt/module/hadoop-3.3.1/logs 和/opt/module/hadoop-3.3.1/data 文件夹</li><li>格式化<code>hdfs namenode -format</code></li><li>开启 hdfs 服务</li><li>开启 yarn 服务</li></ol><h2 id=六hadoop-常用脚本>六、hadoop 常用脚本
<a class=heading-link href=#%e5%85%adhadoop-%e5%b8%b8%e7%94%a8%e8%84%9a%e6%9c%ac><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>#集群启停脚本</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$#</span> -lt <span class=m>1</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;no args input...&#34;</span>
</span></span><span class=line><span class=cl>	exit<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>case</span> <span class=nv>$1</span> in
</span></span><span class=line><span class=cl>	<span class=s2>&#34;start&#34;</span> <span class=o>)</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;============================启动hadoop集群=================&#34;</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;============================启动hdfs======================&#34;</span>
</span></span><span class=line><span class=cl>		ssh hadoop102 <span class=s2>&#34;/opt/module/hadoop-3.3.1/sbin/start-dfs.sh&#34;</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;============================启动yarn======================&#34;</span>
</span></span><span class=line><span class=cl>		ssh hadoop103 <span class=s2>&#34;/opt/module/hadoop-3.3.1/sbin/start-yarn.sh&#34;</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;======================启动historyserver======================&#34;</span>
</span></span><span class=line><span class=cl>		ssh hadoop102 <span class=s2>&#34;/opt/module/hadoop-3.3.1/bin/mapred --daemon start historyserver&#34;</span>
</span></span><span class=line><span class=cl>		<span class=p>;;</span>
</span></span><span class=line><span class=cl>	<span class=s2>&#34;stop&#34;</span> <span class=o>)</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;=========================关闭hadoop集群=================&#34;</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;======================关闭historyserver===================&#34;</span>
</span></span><span class=line><span class=cl>		ssh hadoop102 <span class=s2>&#34;/opt/module/hadoop-3.3.1/bin/mapred --daemon stop historyserver&#34;</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;============================关闭yarn======================&#34;</span>
</span></span><span class=line><span class=cl>		ssh hadoop103 <span class=s2>&#34;/opt/module/hadoop-3.3.1/sbin/stop-yarn.sh&#34;</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;============================关闭hdfs======================&#34;</span>
</span></span><span class=line><span class=cl>		ssh hadoop102 <span class=s2>&#34;/opt/module/hadoop-3.3.1/sbin/stop-dfs.sh&#34;</span>
</span></span><span class=line><span class=cl>		<span class=p>;;</span>
</span></span><span class=line><span class=cl>	* <span class=o>)</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;input args error....&#34;</span>
</span></span><span class=line><span class=cl>	<span class=p>;;</span>
</span></span><span class=line><span class=cl><span class=k>esac</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>#查看集群是否启动成功</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> host in hadoop102 hadoop103 hadoop104
</span></span><span class=line><span class=cl><span class=k>do</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=o>=========================</span><span class=nv>$host</span><span class=o>================</span>
</span></span><span class=line><span class=cl>	ssh <span class=nv>$host</span> jps
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></div><h2 id=七hadoop-常用端口号>七、hadoop 常用端口号
<a class=heading-link href=#%e4%b8%83hadoop-%e5%b8%b8%e7%94%a8%e7%ab%af%e5%8f%a3%e5%8f%b7><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><blockquote><p><strong>hadoop3.x</strong>
hdfs namenode 内部常用端口：8020/9000/9820
hdfs namenode 对用户的查询端口：9870
yarn 查看任务运行情况的端口：8088
历史服务器：19888
<strong>hadoop2.x</strong>
hdfs namenode 内部常用端口：8020/9000
hdfs namenode 对用户的查询端口：50070
yarn 查看任务运行情况的端口：8088
历史服务器：19888
常用配置文件
<strong>hadoop3.x</strong>
core-site.xml hdfs-site.xml yran-site.xml mapred-site.xml workers
<strong>hadoop2.x</strong>
core-site.xml hdfs-site.xml yran-site.xml mapred-site.xml slaves</p></blockquote><h2 id=八集群时间同步>八、集群时间同步
<a class=heading-link href=#%e5%85%ab%e9%9b%86%e7%be%a4%e6%97%b6%e9%97%b4%e5%90%8c%e6%ad%a5><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><h3 id=注意>注意
<a class=heading-link href=#%e6%b3%a8%e6%84%8f><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>生产环境：如果服务器能连接外网，不需要时间同步，会同步外网的时间
生产环境：如果服务器不能连接外网，需要时间同步</p><h3 id=1102-机器配置选择一个作为时间同步的主机>（1）102 机器配置（选择一个作为时间同步的主机）
<a class=heading-link href=#1102-%e6%9c%ba%e5%99%a8%e9%85%8d%e7%bd%ae%e9%80%89%e6%8b%a9%e4%b8%80%e4%b8%aa%e4%bd%9c%e4%b8%ba%e6%97%b6%e9%97%b4%e5%90%8c%e6%ad%a5%e7%9a%84%e4%b8%bb%e6%9c%ba><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>切换 root 账号
<code>su root</code>
查看状态
<code>systemctl status ntpd</code>
开启
<code>systemctl start ntpd</code>
查看开机自启状态
<code>systemctl is-enabled ntpd</code>
修改配置文件
<code>vim /etc/ntp.conf</code></p><p><img alt=在这里插入图片描述 src="https://img-blog.csdnimg.cn/fce9dc0b505e4589b8863a698dd6344b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAUG15eF93eWg=,size_20,color_FFFFFF,t_70,g_se,x_16">
在最后追加</p><pre tabindex=0><code>server 127.127.1.0
fudge 127.127.1.0 stratum 10
</code></pre><p><img alt=在这里插入图片描述 src=https://img-blog.csdnimg.cn/4d08783bd7754b43b1e57bee6d1d25a4.png>
修改/etc/sysconfig/ntpd 文件
<code>vim /etc/sysconfig/ntpd</code>
增加以下内容（让硬件时间与系统时间一起同步）
<code>SYNC_HWCLOCK=yes</code>
重启 ntpd 服务
<code>systemctl start ntpd</code>
设置 ntpd 服务开机自启
<code>systemctl enable ntpd</code></p><h3 id=2其他机器配置>（2）其他机器配置
<a class=heading-link href=#2%e5%85%b6%e4%bb%96%e6%9c%ba%e5%99%a8%e9%85%8d%e7%bd%ae><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><h4 id=1关闭所有节点的-ntp-服务和自启动>1.关闭所有节点的 ntp 服务和自启动
<a class=heading-link href=#1%e5%85%b3%e9%97%ad%e6%89%80%e6%9c%89%e8%8a%82%e7%82%b9%e7%9a%84-ntp-%e6%9c%8d%e5%8a%a1%e5%92%8c%e8%87%aa%e5%90%af%e5%8a%a8><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h4><p><code>systemctl stop ntpd</code>
<code>systemctl disable ntpd</code></p><h4 id=2一分钟与时间服务器选择的主机做一次时间同步>2.一分钟与时间服务器选择的主机做一次时间同步
<a class=heading-link href=#2%e4%b8%80%e5%88%86%e9%92%9f%e4%b8%8e%e6%97%b6%e9%97%b4%e6%9c%8d%e5%8a%a1%e5%99%a8%e9%80%89%e6%8b%a9%e7%9a%84%e4%b8%bb%e6%9c%ba%e5%81%9a%e4%b8%80%e6%ac%a1%e6%97%b6%e9%97%b4%e5%90%8c%e6%ad%a5><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h4><p><code>crontab -e</code>
<code>* * * * * 从左到右依次是 分时日月周</code>
添加定时任务如下</p><pre tabindex=0><code class=language-crontab data-lang=crontab>*/1 * * * *   /usr/sbin/ntpdate hadoop102
</code></pre><p>测试：
<code>date -s "2022-02-22 22:22:22"</code>
一分钟后查看是否同步
<code>date</code></p></div><footer><section class=see-also><h3 id=see-also-in-编程系列>See also in 编程系列
<a class=heading-link href=#see-also-in-%e7%bc%96%e7%a8%8b%e7%b3%bb%e5%88%97><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><nav><ul><li><a href=/posts/2309091559/>golang获取百度查询结果并截屏封装windows程序</a></li><li><a href=/posts/2309021559/>获取百度查询结果并截屏</a></li><li><a href=/posts/2308071644/>Go开发之初始化（1）</a></li><li><a href=/posts/2308070926/>html5+css小知识（2）</a></li><li><a href=/posts/2308070957/>html5+css小知识（1）</a></li><li><a href=/posts/2308061943/>前端vue小知识</a></li></ul></nav></section></footer></article></section></div><footer class=footer><section class=container>©
2019 -
2024
YanHowey Wang
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>