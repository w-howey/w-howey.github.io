<!doctype html><html lang=en><head><title>laravel+tp项目如何上线以及ssl证书的配置 · YanHowey Wang
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="YanHowey Wang"><meta name=description content="写完的项目如何部署上线呢？ Link to heading 前言：前几天的文章有写到虚拟机的安装那一块，配置了 nginx，mysql，和 php Link to heading （一）域名解析及 ssl 证书的申请 Link to heading 以腾讯云为例：
进入控制台，域名管理，解析，会进入到另外一个页面 添加记录 主机记录：abc 记录类型：A 线路类型：默认 记录值：服务器公网 ip 其他不用改，直接解析 注：（1）如果你在主机记录第一个框中填入了 www，代表你解析的是一级域名，一级域名只能绑一个项目，也就是你上线后你的域名需要www.xxxx.com , （2）解析成二级域名，主机记录框随便写，例如 abc，那么访问就变成了abc.xxxx.com 申请 ssl 证书（可要可不要，没有就是 http 连接访问，申请后配置可转换为 https 访问）例如：没有证书：http://abc.xxxxx.com加了证书之后https://abc.xxxx.com 证书的申请步骤： (1) 控制台，云产品点进 ssl 证书 （2）申请免费证书 （3）等待审核，审核完后才能下载到本地 （二）xshell 连接服务器，配置 nginx Link to heading 命令：ssh xxx@xx.xxx.xx.xxx //xxx:线上服务器用户名可修改 xx.xxx.xx.xxx:服务器公网ip 然后会弹出一个框再输入线上服务器的密码 sudo su //管理员权限 cd /返回根目录 cd etc/nginx/sites-available/ //进入nginx下面 ls cp default php //php是我随意定义的 vi php laravel 项目将 nginx 做如下配置 详细代码如下："><meta name=keywords content="blog,编程,前端,后端"><meta name=twitter:card content="summary"><meta name=twitter:title content="laravel+tp项目如何上线以及ssl证书的配置"><meta name=twitter:description content="写完的项目如何部署上线呢？ Link to heading 前言：前几天的文章有写到虚拟机的安装那一块，配置了 nginx，mysql，和 php Link to heading （一）域名解析及 ssl 证书的申请 Link to heading 以腾讯云为例：
进入控制台，域名管理，解析，会进入到另外一个页面 添加记录 主机记录：abc 记录类型：A 线路类型：默认 记录值：服务器公网 ip 其他不用改，直接解析 注：（1）如果你在主机记录第一个框中填入了 www，代表你解析的是一级域名，一级域名只能绑一个项目，也就是你上线后你的域名需要www.xxxx.com , （2）解析成二级域名，主机记录框随便写，例如 abc，那么访问就变成了abc.xxxx.com 申请 ssl 证书（可要可不要，没有就是 http 连接访问，申请后配置可转换为 https 访问）例如：没有证书：http://abc.xxxxx.com加了证书之后https://abc.xxxx.com 证书的申请步骤： (1) 控制台，云产品点进 ssl 证书 （2）申请免费证书 （3）等待审核，审核完后才能下载到本地 （二）xshell 连接服务器，配置 nginx Link to heading 命令：ssh xxx@xx.xxx.xx.xxx //xxx:线上服务器用户名可修改 xx.xxx.xx.xxx:服务器公网ip 然后会弹出一个框再输入线上服务器的密码 sudo su //管理员权限 cd /返回根目录 cd etc/nginx/sites-available/ //进入nginx下面 ls cp default php //php是我随意定义的 vi php laravel 项目将 nginx 做如下配置 详细代码如下："><meta property="og:url" content="https://howey.deno.dev/posts/2307262212/"><meta property="og:site_name" content="YanHowey Wang"><meta property="og:title" content="laravel+tp项目如何上线以及ssl证书的配置"><meta property="og:description" content="写完的项目如何部署上线呢？ Link to heading 前言：前几天的文章有写到虚拟机的安装那一块，配置了 nginx，mysql，和 php Link to heading （一）域名解析及 ssl 证书的申请 Link to heading 以腾讯云为例：
进入控制台，域名管理，解析，会进入到另外一个页面 添加记录 主机记录：abc 记录类型：A 线路类型：默认 记录值：服务器公网 ip 其他不用改，直接解析 注：（1）如果你在主机记录第一个框中填入了 www，代表你解析的是一级域名，一级域名只能绑一个项目，也就是你上线后你的域名需要www.xxxx.com , （2）解析成二级域名，主机记录框随便写，例如 abc，那么访问就变成了abc.xxxx.com 申请 ssl 证书（可要可不要，没有就是 http 连接访问，申请后配置可转换为 https 访问）例如：没有证书：http://abc.xxxxx.com加了证书之后https://abc.xxxx.com 证书的申请步骤： (1) 控制台，云产品点进 ssl 证书 （2）申请免费证书 （3）等待审核，审核完后才能下载到本地 （二）xshell 连接服务器，配置 nginx Link to heading 命令：ssh xxx@xx.xxx.xx.xxx //xxx:线上服务器用户名可修改 xx.xxx.xx.xxx:服务器公网ip 然后会弹出一个框再输入线上服务器的密码 sudo su //管理员权限 cd /返回根目录 cd etc/nginx/sites-available/ //进入nginx下面 ls cp default php //php是我随意定义的 vi php laravel 项目将 nginx 做如下配置 详细代码如下："><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-26T22:21:16+08:00"><meta property="article:modified_time" content="2023-07-26T22:21:16+08:00"><meta property="article:tag" content="Php"><meta property="article:tag" content="Laravel"><meta property="article:tag" content="Thinkphp"><meta property="article:tag" content="Nginx"><meta property="og:see_also" content="https://howey.deno.dev/posts/202241106/"><meta property="og:see_also" content="https://howey.deno.dev/posts/241105/"><meta property="og:see_also" content="https://howey.deno.dev/posts/docker-24081323/"><meta property="og:see_also" content="https://howey.deno.dev/posts/docker-240813/"><meta property="og:see_also" content="https://howey.deno.dev/posts/docker-2408132316/"><meta property="og:see_also" content="https://howey.deno.dev/posts/2407111509/"><meta property="og:see_also" content="https://howey.deno.dev/posts/2407111445/"><link rel=canonical href=https://howey.deno.dev/posts/2307262212/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.5adbe72fc41dcfb852215b84695288939b6b606db73238bd3ee936469572fc9c.css integrity="sha256-WtvnL8Qdz7hSIVuEaVKIk5trYG23Mji9Puk2RpVy/Jw=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/pagination.min.ed23f65c60bf3db5f28ed3b249e384cd64c7980184d5100b6d22f278be00ef1a.css integrity="sha256-7SP2XGC/PbXyjtOySeOEzWTHmAGE1RALbSLyeL4A7xo=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>YanHowey Wang
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/categories/>Categories</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/website/>WebSite</a></li><li class=navigation-item><a class=navigation-link href=/contact/>Contact me</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://howey.deno.dev/posts/2307262212/>laravel+tp项目如何上线以及ssl证书的配置</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2023-07-26T22:21:16+08:00>July 26, 2023
</time></span><span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
2-minute read</span></div><div class=authors><i class="fa fa-user" aria-hidden=true></i>
<a href=/authors/howey/>Howey</a></div><div class=categories><i class="fa fa-folder" aria-hidden=true></i>
<a href=/categories/%E5%90%8E%E7%AB%AF/>后端</a></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/php/>Php</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/laravel/>Laravel</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/thinkphp/>Thinkphp</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/nginx/>Nginx</a></span></div></div></header><div class=post-content><h3 id=写完的项目如何部署上线呢>写完的项目如何部署上线呢？
<a class=heading-link href=#%e5%86%99%e5%ae%8c%e7%9a%84%e9%a1%b9%e7%9b%ae%e5%a6%82%e4%bd%95%e9%83%a8%e7%bd%b2%e4%b8%8a%e7%ba%bf%e5%91%a2><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><h4 id=前言前几天的文章有写到虚拟机的安装那一块配置了-nginxmysql和-php>前言：前几天的文章有写到虚拟机的安装那一块，配置了 nginx，mysql，和 php
<a class=heading-link href=#%e5%89%8d%e8%a8%80%e5%89%8d%e5%87%a0%e5%a4%a9%e7%9a%84%e6%96%87%e7%ab%a0%e6%9c%89%e5%86%99%e5%88%b0%e8%99%9a%e6%8b%9f%e6%9c%ba%e7%9a%84%e5%ae%89%e8%a3%85%e9%82%a3%e4%b8%80%e5%9d%97%e9%85%8d%e7%bd%ae%e4%ba%86-nginxmysql%e5%92%8c-php><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h4><h5 id=一域名解析及-ssl-证书的申请>（一）域名解析及 ssl 证书的申请
<a class=heading-link href=#%e4%b8%80%e5%9f%9f%e5%90%8d%e8%a7%a3%e6%9e%90%e5%8f%8a-ssl-%e8%af%81%e4%b9%a6%e7%9a%84%e7%94%b3%e8%af%b7><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h5><p>以腾讯云为例：</p><ol><li>进入控制台，域名管理，解析，会进入到另外一个页面
<img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS04MjFhN2U3NDFjMDk2N2FhLnBuZw></li><li>添加记录
<img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS01ODZlM2FjYjFjNTYzMzY5LnBuZw>
主机记录：abc
记录类型：A
线路类型：默认
记录值：服务器公网 ip
其他不用改，直接解析
<code>注：</code>（1）如果你在主机记录第一个框中填入了 www，代表你解析的是一级域名，一级域名只能绑一个项目，也就是你上线后你的域名需要<code>www.xxxx.com</code> ,
（2）解析成二级域名，主机记录框随便写，例如 abc，那么访问就变成了<code>abc.xxxx.com</code></li><li>申请 ssl 证书（可要可不要，没有就是 http 连接访问，申请后配置可转换为 https 访问）例如：没有证书：<code>http://abc.xxxxx.com</code>加了证书之后<code>https://abc.xxxx.com</code>
证书的申请步骤：
(1) 控制台，云产品点进 ssl 证书
<img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS1hODQ3ZjJhMGFiNzNmYTVmLnBuZw>
（2）申请免费证书
<img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS0yMDc5OTVmZjI1ZmJlZWFlLnBuZw>
（3）等待审核，审核完后才能下载到本地</li></ol><h5 id=二xshell-连接服务器配置-nginx>（二）xshell 连接服务器，配置 nginx
<a class=heading-link href=#%e4%ba%8cxshell-%e8%bf%9e%e6%8e%a5%e6%9c%8d%e5%8a%a1%e5%99%a8%e9%85%8d%e7%bd%ae-nginx><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h5><p>命令：<code>ssh xxx@xx.xxx.xx.xxx //xxx:线上服务器用户名可修改 xx.xxx.xx.xxx:服务器公网ip</code> 然后会弹出一个框再输入线上服务器的密码
<code>sudo su //管理员权限</code>
<code>cd /</code>返回根目录
<code>cd etc/nginx/sites-available/ //进入nginx下面</code>
<code>ls</code>
<code>cp default php //php是我随意定义的</code>
<code>vi php</code>
laravel 项目将 nginx 做如下配置
<img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS0wNzk0YTNhNDMxOWRlMjg0LnBuZw>
详细代码如下：</p><pre tabindex=0><code>server {
        listen 80;
        server_name abc.xxxx.com;
        server_tokens off;
        location / {
          return 301 https://$host$request_uri;
        }
}
server {
        listen       443 ssl;
        ssl on;         //开启证书
        ssl_certificate       /opt/Nginx/abc.crt;    //证书位置
        ssl_certificate_key    /opt/Nginx/abc.key;   //key位置
        root /var/www/abc/public;
        index index.html index.htm index.php index.nginx-debian.html;
        server_name abc.xxxx.com;
        location / {
                try_files $uri $uri/ /index.php?$query_string;
        }
        location ~ .php$ {
              include snippets/fastcgi-php.conf;
              fastcgi_pass unix:/run/php/php7.2-fpm.sock;
      }

}
</code></pre><p><code>注意：</code>thinkphp 项目与其不同，路由那里需要重写,默认的是将
上面的这一段</p><pre tabindex=0><code> location / {
                try_files $uri $uri/ /index.php?$query_string;
        }
</code></pre><p>改写为</p><pre tabindex=0><code>#根据框架需求，配置url重写
      location / {
              try_files $uri $uri/ =404;
      }
</code></pre><p>但是 url 模式不同需要重写路由，先将将 URL_MODEL 设置为 2，然后改写为：</p><pre tabindex=0><code>location / {
if (!-e $request_filename) {
   rewrite  ^(.*)$  /index.php?s=$1  last;
   break;
    }
 }
</code></pre><p><code>注：</code>第二段 location 可以改写为：</p><pre tabindex=0><code>  location ~ \.php$ {
                try_files $uri /index.php =404;
                fastcgi_split_path_info ^(.+\.php)(/.+)$;
                fastcgi_pass unix:/var/run/php/php7.2-fpm.sock;
                fastcgi_index index.php;
                fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
                include fastcgi_params;
        }
</code></pre><p>配置完成之后按 esc+：键输入<code>wq</code>保存并退出 linux 命令<code>vi vim //打开的方式不同</code> 注意一下，<code>q! //强制退出</code>
命令：<code>nginx -t //检查配置有没有错误</code>
<code>service nginx restart //重启nginx服务</code>
命令：<code>cd /</code>
<code>cd var</code>
<code>ls</code>
<code>chmod -R 777 www //给权限</code></p><h5 id=三配置线上数据库>（三）配置线上数据库
<a class=heading-link href=#%e4%b8%89%e9%85%8d%e7%bd%ae%e7%ba%bf%e4%b8%8a%e6%95%b0%e6%8d%ae%e5%ba%93><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h5><ol><li>新建 mysql 连接
<img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS1jODQ0YmIwODA0Y2M4Y2ZlLnBuZw>
然后点击 ssh
<img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS1hNDQwNmVmN2U1MzNkODAzLnBuZw></li><li>新建数据库 名字与本地一致，然后导入 sql 文件，刷新就可以看见表了 ####（四）上传项目</li><li>将项目打包成 zip 格式</li><li>打开 FileZilla Client 软件，这个网上直接下载很方便的</li><li><img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS1hYmJkOGE3YTFmYzliNzg1LnBuZw></li><li>将打包的项目拖到线上站点的/var/www/下面</li><li>将下载的 ssl 证书解压打开有一个 Nginx 的文件夹，打开将文件的长名字改为短名字，与之前 nginx 证书位置设置的名字一样，然后压缩 Nginx 文件夹，并拖到/opt/文件夹下面，发现传输失败</li><li>回到 xshell 给<code>chmod -R 777 opt</code>权限，然后再传输</li><li>linux 安装解压缩 命令：<code>apt-get install unzip</code></li><li>cd 命令进入 www 解压缩<code>unzip xxx</code>；然后给权限<code>chmod -R 777 xxx</code></li><li>cd 命令进入 opt，解压缩证书,然后删除压缩包</li><li>cd 进入项目文件 命令：<code>vi .env</code>对 env 文件里面的本地数据改为线上的例如数据库等等其他环境变量；</li></ol><h4 id=五测试访问-ok>（五）测试访问 ok！！！
<a class=heading-link href=#%e4%ba%94%e6%b5%8b%e8%af%95%e8%ae%bf%e9%97%ae-ok><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h4><h4 id=六线上线下开启自动同步修改线下的代码让线上与之同步>（六）线上线下开启自动同步：修改线下的代码让线上与之同步
<a class=heading-link href=#%e5%85%ad%e7%ba%bf%e4%b8%8a%e7%ba%bf%e4%b8%8b%e5%bc%80%e5%90%af%e8%87%aa%e5%8a%a8%e5%90%8c%e6%ad%a5%e4%bf%ae%e6%94%b9%e7%ba%bf%e4%b8%8b%e7%9a%84%e4%bb%a3%e7%a0%81%e8%ae%a9%e7%ba%bf%e4%b8%8a%e4%b8%8e%e4%b9%8b%e5%90%8c%e6%ad%a5><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h4><p>点击 Configuration
<img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS01YmU4M2UxODI4ZWU0NDFmLnBuZw>
做如下配置
<img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS1hYmZjOGRiYzY3MTMyNTdkLnBuZw>
勾选自动上传
<img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS0wMjg5ZDkwZjkyYjRjMDdjLnBuZw>
取消勾选
<img alt=image.png src=https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODgyMDk3NS01OTRmYWUxZWEwZWU3ZDhhLnBuZw></p></div><footer><section class=see-also><h3 id=see-also-in-编程系列>See also in 编程系列
<a class=heading-link href=#see-also-in-%e7%bc%96%e7%a8%8b%e7%b3%bb%e5%88%97><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><nav><ul><li><a href=/posts/202241106/>java自动化控制鼠标和键盘</a></li><li><a href=/posts/241105/>在浏览器扩展开发中，popup.js、content.js 和 background.js作用以及通信</a></li><li><a href=/posts/docker-24081323/>docker 镜像结构</a></li><li><a href=/posts/docker-240813/>docker 数据卷挂</a></li><li><a href=/posts/docker-2408132316/>docker 网络</a></li><li><a href=/posts/2407111509/>springboot中application.xml多环境配置</a></li></ul></nav></section></footer></article></section></div><footer class=footer><section class=container>©
2019 -
2024
YanHowey Wang
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>